import matplotlib.pyplot as plt
import numpy as np
plt.rc("font", **{"family": "serif", "serif": ["Times New Roman", "DejaVu Serif", "Liberation Serif"]})

# SEGMENT 0 DATA
segment_0_initial = [
    # First sub-array
    [
        [302.49994, 227.81567],
        [284.04974, 227.75792],
        [288.12735, 214.69066],
        [290.32562, 222.01329],
        [290.239, 228.03844],
        [290.1748, 233.93808],
        [290.24146, 240.22974],
        [295.8513, 215.78986],
        [296.01096, 221.75595],
        [296.27545, 228.04796],
        [296.1493, 234.09875],
        [295.97324, 240.06157],
        [302.16843, 210.12048],
        [302.22028, 215.8507],
        [302.35922, 221.84291],
        [302.49994, 227.81567],
        [302.38174, 233.76376],
        [302.18433, 239.78716],
        [308.14062, 215.80414],
        [308.52194, 222.00748],
        [308.6403, 228.07224],
        [308.3436, 233.90791],
        [308.1057, 239.95117],
        [313.70047, 215.32619],
        [313.97968, 221.49924],
        [313.84146, 227.6984],
        [313.8288, 233.68665],
        [313.40314, 239.07616],
    ],
    # Second sub-array
    [
        [284.64117, 238.55392],
        [264.47623, 238.5467],
        [270.60016, 224.59761],
        [271.47012, 231.80943],
        [270.90002, 238.61266],
        [270.67416, 245.4307],
        [271.00137, 252.08023],
        [277.85678, 225.03671],
        [278.30524, 231.78038],
        [277.822, 238.51602],
        [277.49277, 245.37038],
        [277.95526, 251.46242],
        [283.84238, 217.52234],
        [284.95123, 225.036],
        [284.73178, 231.75638],
        [284.64117, 238.55392],
        [284.905, 245.15117],
        [284.52975, 251.14072],
        [291.35733, 225.22319],
        [291.41992, 232.19061],
        [291.3941, 238.705],
        [291.37912, 245.13641],
        [291.37924, 251.3857],
        [298.29828, 225.35942],
        [298.52554, 232.0967],
        [298.18823, 238.64821],
        [297.97165, 244.94977],
        [298.16693, 251.54802],
    ],
    # Third sub-array
    [
        [251.91994, 260.82648],
        [233.88387, 260.74332],
        [240.07402, 248.7783],
        [240.0788, 254.31978],
        [239.9356, 260.87518],
        [239.36269, 266.9227],
        [240.04163, 272.8637],
        [245.71887, 248.7383],
        [245.5148, 254.05205],
        [245.7375, 260.7354],
        [245.79008, 267.20056],
        [245.85422, 272.68555],
        [251.91295, 242.98827],
        [252.02151, 249.18285],
        [251.88078, 254.73872],
        [251.91994, 260.82648],
        [251.6692, 266.75467],
        [252.07982, 272.5352],
        [257.79297, 248.94293],
        [257.50436, 254.69283],
        [257.39966, 260.59653],
        [258.0347, 266.76672],
        [257.81567, 272.2273],
        [263.5164, 249.37575],
        [263.25702, 254.80925],
        [263.5938, 261.0824],
        [263.87933, 266.26752],
        [263.89038, 272.77304],
    ],
]

segment_0_final = [
    # First sub-array
    [
        [340.67627, 212.04391],
        [328.17654, 207.51674],
        [326.9934, 196.67789],
        [328.66373, 201.14072],
        [332.73682, 210.62582],
        [330.51248, 214.93504],
        [328.75757, 221.24127],
        [333.27548, 196.35088],
        [336.7711, 201.98253],
        [337.57385, 211.16443],
        [335.5984, 215.374],
        [334.52753, 221.22427],
        [317.26096, 190.77159],
        [341.64584, 197.31049],
        [343.9309, 203.16864],
        [340.67627, 212.04391],
        [338.0162, 215.29164],
        [338.95706, 221.59296],
        [343.845, 196.41304],
        [346.2718, 202.81717],
        [346.0979, 211.64291],
        [344.73203, 216.20218],
        [345.09146, 221.9639],
        [350.33545, 197.70886],
        [351.25018, 204.73363],
        [350.01868, 213.06743],
        [349.1948, 218.37967],
        [349.22275, 223.31137],
    ],
    # Second sub-array
    [
        [324.93787, 220.61583],
        [306.88577, 222.29102],
        [314.4165, 207.52219],
        [311.41086, 212.87146],
        [313.5124, 219.03363],
        [310.7343, 226.36841],
        [309.17447, 233.96735],
        [321.19473, 207.44067],
        [316.58636, 212.26962],
        [317.4573, 219.7757],
        [314.28207, 227.25064],
        [312.7196, 235.71925],
        [315.3631, 204.15071],
        [325.52298, 206.56865],
        [327.3564, 210.32077],
        [324.93787, 220.61583],
        [323.58105, 228.01694],
        [320.08786, 235.2986],
        [334.3626, 206.95201],
        [332.75525, 213.55264],
        [330.30707, 219.83186],
        [327.02475, 229.02087],
        [323.96866, 236.56534],
        [338.07434, 206.54861],
        [336.95215, 214.24026],
        [335.25137, 220.1113],
        [333.98505, 228.3527],
        [329.2535, 233.75175],
    ],
    # Third sub-array
    [
        [292.19803, 237.39272],
        [274.42337, 241.223],
        [279.18274, 232.09161],
        [281.15567, 236.08836],
        [281.74518, 238.79134],
        [277.66647, 243.98563],
        [276.5579, 253.97377],
        [286.1202, 231.46193],
        [286.8191, 234.79883],
        [286.14883, 238.25589],
        [286.7386, 246.90588],
        [282.86267, 254.8699],
        [294.39465, 225.47777],
        [292.57867, 231.55212],
        [293.3466, 233.72475],
        [292.19803, 237.39272],
        [290.21143, 246.8217],
        [289.26962, 254.73494],
        [297.84756, 232.35016],
        [295.56796, 235.47589],
        [294.57816, 241.104],
        [291.23773, 249.52544],
        [288.1855, 257.58594],
        [303.51108, 230.90388],
        [300.54184, 237.33192],
        [299.59552, 242.4301],
        [296.6021, 249.4345],
        [291.62637, 256.90384],
    ],
]

# SEGMENT 1 DATA
segment_1_initial = [
    # First sub-array
    [
        [341.16995, 213.13593],
        [328.89417, 207.97307],
        [327.10416, 196.79425],
        [329.9071, 201.56885],
        [333.61615, 211.22864],
        [331.10165, 215.57271],
        [329.49802, 222.17203],
        [334.69785, 197.1231],
        [337.77313, 202.53586],
        [338.26608, 212.19096],
        [336.54498, 216.5074],
        [335.4954, 222.39648],
        [349.46393, 209.4136],
        [342.4819, 197.46883],
        [344.73953, 204.12315],
        [341.16995, 213.13593],
        [338.71112, 216.33562],
        [339.64365, 222.7779],
        [344.76755, 197.10277],
        [347.057, 203.67311],
        [346.5651, 212.60283],
        [345.38916, 216.99568],
        [345.78943, 223.17677],
        [351.22452, 198.12025],
        [352.25394, 205.63824],
        [350.6184, 213.77988],
        [349.7768, 218.75136],
        [349.86273, 224.32526],
    ],
    # Second sub-array
    [
        [325.6531, 221.56384],
        [308.29886, 223.10594],
        [315.47736, 208.21643],
        [312.10132, 213.22745],
        [314.14365, 219.43703],
        [311.976, 227.15894],
        [310.1039, 234.50298],
        [321.60208, 207.7676],
        [317.31732, 212.71591],
        [318.14896, 220.4195],
        [315.25912, 227.9584],
        [313.54092, 236.34285],
        [315.8601, 204.45319],
        [326.5025, 207.21269],
        [328.10614, 211.04372],
        [325.6531, 221.56384],
        [324.94458, 229.37186],
        [321.24045, 236.14459],
        [335.4351, 207.64772],
        [333.5866, 214.34138],
        [331.0393, 220.72733],
        [328.00656, 230.30862],
        [325.32245, 237.63312],
        [338.73126, 207.17804],
        [337.6643, 215.40787],
        [336.18506, 221.12407],
        [334.92093, 229.35368],
        [330.76053, 235.14636],
    ],
    # Third sub-array
    [
        [293.11618, 237.24875],
        [275.33173, 241.66675],
        [280.5883, 232.7899],
        [282.23022, 236.26056],
        [282.7538, 238.95667],
        [279.12558, 244.15968],
        [277.07532, 254.4955],
        [287.26318, 231.67366],
        [288.19366, 234.8914],
        [287.3841, 238.49937],
        [288.00085, 247.54613],
        [284.0286, 255.14406],
        [295.63733, 226.08409],
        [293.48813, 231.68936],
        [294.27496, 233.71002],
        [293.11618, 237.24875],
        [291.27136, 247.6251],
        [290.64725, 255.04105],
        [298.8629, 232.65218],
        [296.55963, 235.42886],
        [295.64154, 241.79753],
        [292.2085, 250.29605],
        [289.80154, 257.7024],
        [304.38336, 230.726],
        [301.45554, 237.52667],
        [300.79532, 243.1041],
        [298.12866, 250.24352],
        [292.835, 256.76706],
    ],
]

segment_1_final = [
    # First sub-array
    [
        [430.447, 226.75674],
        [411.6788, 212.90318],
        [341.80362, 189.3843],
        [414.87143, 206.55974],
        [417.75397, 218.4972],
        [414.44388, 222.88837],
        [411.54132, 225.76924],
        [422.7146, 208.77179],
        [418.61734, 214.17694],
        [424.39212, 222.8799],
        [420.39545, 225.92738],
        [416.72372, 231.3394],
        [435.90234, 225.5384],
        [428.5533, 211.77583],
        [425.3218, 220.33092],
        [430.447, 226.75674],
        [423.48132, 225.89188],
        [422.27182, 233.20558],
        [430.6172, 214.30049],
        [431.66977, 218.69012],
        [431.31165, 225.2121],
        [430.04605, 231.98077],
        [428.7477, 236.53468],
        [435.07208, 217.57603],
        [435.74673, 222.39442],
        [436.53555, 228.14241],
        [433.92126, 234.82074],
        [432.80988, 238.11938],
    ],
    # Second sub-array
    [
        [407.82056, 221.84308],
        [391.99237, 216.10582],
        [388.96878, 200.3856],
        [397.66165, 208.09332],
        [395.48114, 214.01462],
        [397.08334, 221.03015],
        [386.0375, 225.07796],
        [406.01715, 209.52783],
        [400.8695, 209.62051],
        [400.68747, 219.83035],
        [388.18735, 222.2971],
        [384.74658, 229.29588],
        [347.7177, 183.57687],
        [410.20132, 209.85112],
        [408.70526, 214.79225],
        [407.82056, 221.84308],
        [402.94415, 231.61867],
        [393.1889, 234.25418],
        [419.86932, 215.95514],
        [418.58203, 223.36298],
        [413.44562, 226.26898],
        [405.9822, 234.55734],
        [397.08524, 238.87215],
        [423.06747, 219.04097],
        [422.418, 224.68085],
        [419.67532, 230.51085],
        [414.9056, 238.19395],
        [404.55362, 237.5152],
    ],
    # Third sub-array
    [
        [360.25476, 218.02596],
        [357.95932, 218.86713],
        [358.59763, 216.47261],
        [356.8014, 218.43488],
        [331.00558, 223.29755],
        [332.60815, 232.03242],
        [311.58643, 243.86661],
        [347.7035, 211.60968],
        [363.56125, 217.99406],
        [362.80917, 219.26086],
        [362.6012, 230.29259],
        [347.00195, 241.48523],
        [378.80435, 212.90886],
        [370.88406, 215.45685],
        [373.0062, 219.64632],
        [360.25476, 218.02596],
        [363.58496, 231.4287],
        [361.72272, 237.78058],
        [371.23535, 217.7994],
        [376.55167, 206.92395],
        [362.48355, 226.73396],
        [368.051, 233.70096],
        [348.22125, 240.71445],
        [374.39426, 221.68925],
        [380.83154, 223.9049],
        [365.0187, 230.14276],
        [370.8365, 236.92657],
        [358.9841, 240.09822],
    ],
]

# SEGMENT 2 DATA
segment_2_initial = [
    # First sub-array
    [
        [431.37463, 227.29045],
        [412.48145, 213.55435],
        [440.0411, 227.3443],
        [415.61157, 207.23326],
        [418.26947, 218.86569],
        [414.92908, 223.0779],
        [412.955, 226.04681],
        [423.52213, 209.55951],
        [419.64447, 215.01578],
        [425.2635, 223.39552],
        [420.9798, 226.30252],
        [418.34042, 232.06747],
        [437.14374, 226.31024],
        [429.9489, 212.65092],
        [426.3545, 220.6604],
        [431.37463, 227.29045],
        [424.40274, 226.1212],
        [423.15466, 233.5451],
        [431.8554, 215.0474],
        [432.45062, 219.28912],
        [432.19525, 225.93591],
        [431.09335, 232.45714],
        [429.53076, 237.00232],
        [436.2005, 218.26578],
        [436.90567, 223.28496],
        [437.76584, 228.93675],
        [434.90726, 235.32901],
        [433.58, 238.74864],
    ],
    # Second sub-array
    [
        [409.09634, 221.8052],
        [393.38495, 216.85469],
        [389.97137, 202.04922],
        [398.4951, 209.13591],
        [396.67307, 214.5167],
        [398.06345, 220.94098],
        [386.43445, 225.35168],
        [407.15985, 210.61415],
        [402.03308, 210.75606],
        [401.81897, 220.11032],
        [388.6447, 222.44397],
        [386.309, 231.25934],
        [402.83417, 224.43477],
        [410.96988, 210.50015],
        [409.97354, 215.44075],
        [409.09634, 221.8052],
        [403.89447, 232.45355],
        [393.78223, 235.4341],
        [420.67654, 216.64587],
        [418.98276, 223.67265],
        [414.64642, 226.36487],
        [406.23224, 234.98746],
        [397.72626, 238.98767],
        [423.8766, 219.4185],
        [423.02686, 224.95996],
        [421.21582, 231.08907],
        [415.58755, 238.35857],
        [404.95816, 238.35869],
    ],
    # Third sub-array
    [
        [361.35703, 218.58737],
        [358.91904, 219.68039],
        [360.03876, 217.28113],
        [357.85483, 219.46384],
        [368.25757, 229.68332],
        [350.41934, 224.04309],
        [362.84384, 230.37758],
        [347.7333, 211.97598],
        [364.43213, 218.51357],
        [363.5425, 219.70483],
        [363.55423, 230.7354],
        [347.6927, 242.03181],
        [379.4305, 213.49176],
        [372.35425, 216.33377],
        [373.2836, 220.16275],
        [361.35703, 218.58737],
        [364.64554, 232.03082],
        [362.47748, 237.75728],
        [372.1826, 218.52776],
        [377.56436, 208.7696],
        [363.2095, 227.12311],
        [368.7113, 234.16689],
        [348.87894, 241.20236],
        [374.44608, 222.18378],
        [381.14365, 223.71268],
        [365.7462, 230.56213],
        [370.50134, 236.84352],
        [360.12836, 240.24352],
    ],
]

segment_2_final = [
    # First sub-array
    [
        [449.61014, 224.41551],
        [438.36053, 208.8149],
        [458.5738, 223.41772],
        [444.1731, 203.67674],
        [433.03085, 218.24403],
        [435.06384, 217.1142],
        [441.69226, 221.85767],
        [452.40063, 206.03235],
        [444.43042, 206.59926],
        [445.43118, 218.54065],
        [440.3503, 222.06316],
        [446.1814, 229.26285],
        [454.84174, 221.24983],
        [457.21463, 205.22607],
        [447.58994, 217.69572],
        [449.61014, 224.41551],
        [446.09882, 219.03532],
        [452.2285, 231.88643],
        [452.62076, 206.9631],
        [451.1039, 216.18521],
        [451.2831, 221.84386],
        [450.19522, 226.51471],
        [445.93344, 252.74585],
        [452.38528, 211.23837],
        [457.49707, 215.76718],
        [456.64035, 225.01216],
        [477.85965, 242.68425],
        [465.96713, 240.78885],
    ],
    # Second sub-array
    [
        [437.25952, 212.08151],
        [415.90393, 212.92754],
        [401.57697, 195.73172],
        [415.05386, 207.32047],
        [416.95523, 210.66252],
        [428.15674, 213.28679],
        [420.16214, 230.90147],
        [431.32077, 205.61298],
        [435.83386, 206.0932],
        [431.61877, 217.45784],
        [417.97665, 213.62582],
        [360.98492, 226.48051],
        [429.7685, 223.5295],
        [440.0014, 206.66245],
        [439.13672, 211.49367],
        [437.25952, 212.08151],
        [436.24234, 235.12437],
        # [484.99985, 378.66614],
        [443.30453, 209.80307],
        [437.0184, 217.94794],
        [436.94913, 224.86559],
        [438.9973, 237.00723],
        [423.27744, 238.34315],
        [445.1793, 218.26352],
        [445.69034, 215.48213],
        [449.63226, 227.56828],
        [445.6867, 237.78827],
        [429.03912, 238.23662],
    ],
    # Third sub-array
    [
        [392.79688, 223.22147],
        [392.5719, 226.71744],
        [380.542, 216.74504],
        [396.2258, 219.47388],
        [400.5833, 231.463],
        [353.81393, 227.43935],
        [398.16266, 229.34532],
        [348.81097, 214.01054],
        [383.3586, 216.51213],
        [395.69214, 231.49934],
        [397.7501, 229.19794],
        [356.06665, 237.09],
        [402.75558, 210.99568],
        [393.21252, 215.42903],
        [401.9829, 229.97258],
        [392.79688, 223.22147],
        [396.37732, 235.45682],
        [381.98077, 239.1005],
        [394.27338, 213.04396],
        [393.49573, 205.95361],
        [396.7203, 229.29672],
        [400.84827, 236.63239],
        [356.54962, 237.25346],
        [392.79623, 221.30045],
        [409.02878, 273.99496],
        [395.59668, 229.97578],
        [394.35632, 241.72124],
        [377.3845, 238.32825],
    ],
]

# SEGMENT 3 DATA
segment_3_initial = [
    # First sub-array
    [
        [450.50778, 224.9969],
        [439.01364, 209.18292],
        [459.4907, 224.14885],
        [444.5975, 204.04802],
        [434.22314, 218.57068],
        [436.35504, 217.45515],
        [442.3996, 222.41443],
        [452.92322, 206.71284],
        [444.71832, 206.71033],
        [445.89685, 218.79562],
        [441.13745, 222.66985],
        [447.13773, 230.13255],
        [456.05338, 222.046],
        [457.40222, 205.80853],
        [447.9696, 218.0034],
        [450.50778, 224.9969],
        [446.6614, 219.39218],
        [452.36957, 231.84537],
        [453.15747, 207.66853],
        [451.6015, 216.72383],
        [452.28265, 222.44466],
        [450.64218, 226.74661],
        [460.74707, 219.32552],
        [453.3152, 211.90901],
        [458.39914, 216.5407],
        [457.64056, 225.75122],
        [442.66983, 213.50272],
        [467.0938, 241.10466],
    ],
    # Second sub-array
    [
        [438.3541, 212.67204],
        [417.11755, 213.75616],
        [402.15384, 196.57906],
        [416.15228, 207.4027],
        [417.74655, 211.19061],
        [429.3061, 214.27188],
        [420.8154, 231.52321],
        [432.31796, 205.92584],
        [436.42114, 206.39438],
        [432.74805, 217.58493],
        [419.12054, 214.78552],
        [434.66492, 221.70116],
        [430.22943, 223.66095],
        [440.25235, 206.87628],
        [439.9745, 211.8892],
        [438.3541, 212.67204],
        [436.75323, 235.69188],
        [414.68228, 214.79749],
        [443.69818, 210.06786],
        [437.96887, 218.28561],
        [437.76535, 225.46852],
        [439.53107, 237.05373],
        [424.0182, 239.2116],
        [445.5774, 218.46826],
        [445.93042, 215.6816],
        [450.1097, 227.81268],
        [445.9927, 238.2585],
        [429.8532, 239.1401],
    ],
    # Third sub-array
    [
        [393.11078, 223.7983],
        [392.95926, 227.42625],
        [380.4907, 216.79805],
        [396.55466, 219.98773],
        [400.68643, 231.82378],
        [397.30066, 222.53897],
        [398.25037, 229.84627],
        [378.80667, 215.88434],
        [383.45135, 216.6787],
        [395.8883, 232.1534],
        [397.79233, 229.67638],
        [356.62595, 237.70493],
        [403.23254, 213.33972],
        [393.54172, 215.77208],
        [402.0044, 230.34952],
        [393.11078, 223.7983],
        [396.1811, 235.61201],
        [382.26736, 239.53482],
        [394.63037, 213.75934],
        [394.10452, 206.95753],
        [396.8008, 229.90508],
        [400.68954, 236.6736],
        [357.07224, 237.80695],
        [393.0682, 221.80246],
        [391.21198, 222.40634],
        [395.74518, 230.6646],
        [394.58878, 242.50586],
        [377.78864, 238.47899],
    ],
]

segment_3_final = [
    # First sub-array
    [
        [449.32343, 320.19116],
        [455.63382, 426.54727],
        [464.41864, 280.78864],
        [465.72375, 271.68558],
        [453.27545, 279.69586],
        [450.78473, 279.0705],
        [424.62726, 432.85858],
        [467.10876, 280.4955],
        [475.99548, 278.644],
        [419.35004, 429.65387],
        [438.9398, 374.08765],
        [450.52045, 289.98196],
        [445.35175, 287.55408],
        [471.40115, 277.9803],
        [456.8811, 367.96945],
        [449.32343, 320.19116],
        [416.9642, 432.3744],
        [466.07596, 281.61655],
        [468.13123, 279.3572],
        [463.5369, 274.64276],
        [463.74, 383.87686],
        [435.73163, 292.60678],
        [466.52643, 279.3865],
        [472.63702, 275.51822],
        [445.63504, 344.80008],
        [435.42963, 269.74628],
        [459.6511, 281.23703],
        [466.72064, 400.18893],
    ],
    # Second sub-array
    [
        [453.63293, 268.34326],
        [438.70657, 247.63321],
        [411.33282, 198.65039],
        [443.99182, 250.57054],
        [407.7, 337.71597],
        [453.92307, 264.55338],
        [426.85782, 265.66705],
        [459.9094, 268.99442],
        [428.1039, 425.40997],
        [449.38367, 258.77673],
        [450.58017, 248.3424],
        [457.90598, 277.88724],
        [441.09747, 273.33936],
        [424.87982, 433.64993],
        [453.73257, 276.62216],
        [453.63293, 268.34326],
        [456.41644, 269.7939],
        [440.7789, 242.62016],
        [430.8463, 422.4597],
        [458.16904, 280.37146],
        [438.89963, 379.82205],
        [457.4569, 252.34634],
        [436.0336, 274.00372],
        [427.36737, 426.20004],
        [444.8655, 348.46887],
        [443.23782, 303.7171],
        [462.48047, 277.58652],
        [445.17813, 272.13562],
    ],
    # Third sub-array
    [
        [406.80652, 233.0631],
        [414.35312, 241.68015],
        [390.4286, 217.65796],
        [408.18268, 220.66457],
        [410.39236, 249.90866],
        [407.41544, 237.68161],
        [416.17285, 244.3433],
        [385.12415, 216.04707],
        [398.17395, 216.5524],
        [406.25015, 251.7028],
        [412.37418, 245.53723],
        [363.69528, 236.0501],
        [415.78653, 230.35321],
        [411.12054, 225.98741],
        [414.43588, 245.91689],
        [406.80652, 233.0631],
        [414.43085, 252.39476],
        [388.10876, 245.2274],
        [409.6538, 218.86638],
        [403.35162, 216.00502],
        [416.83438, 248.37433],
        [417.34467, 256.7137],
        [363.5134, 236.3638],
        [408.40555, 224.03812],
        [409.83118, 226.9948],
        [407.88718, 254.33305],
        [405.4628, 257.7529],
        [403.06238, 236.22467],
    ],
]

# SEGMENT 4 DATA
segment_4_initial = [
    # First sub-array
    [
        [462.4684, 293.2418],
        [444.4574, 287.5906],
        [456.67563, 293.15454],
        [466.7524, 273.1955],
        [468.41425, 281.2664],
        [450.61865, 287.44992],
        [450.4925, 281.8127],
        [467.63397, 280.79224],
        [450.4925, 281.8127],
        [444.6205, 293.38165],
        [468.41425, 281.2664],
        [451.31955, 290.51028],
        [444.4574, 287.5906],
        [472.21368, 278.6871],
        [462.68488, 299.65604],
        [468.41425, 281.2664],
        [457.13806, 306.0362],
        [444.6107, 281.58142],
        [468.68326, 279.8719],
        [462.70047, 281.2817],
        [456.58057, 281.34805],
        [439.1347, 293.77533],
        [456.67563, 293.15454],
        [473.88132, 276.23322],
        [444.6107, 281.58142],
        [444.68802, 305.518],
        [450.4925, 281.8127],
        [457.21814, 299.82953],
    ],
    # Second sub-array
    [
        [454.31082, 269.16757],
        [439.62186, 248.19238],
        [449.561, 266.4626],
        [444.71567, 251.41402],
        [429.39694, 259.0247],
        [454.50604, 265.3351],
        [427.22717, 266.05887],
        [442.65878, 265.9005],
        [456.35114, 252.46887],
        [449.84824, 259.58243],
        [435.92868, 258.6901],
        [435.87286, 251.66917],
        [441.34372, 273.86072],
        [435.87286, 251.66917],
        [429.28476, 265.49487],
        [454.31082, 269.16757],
        [456.35114, 252.46887],
        [429.39694, 259.0247],
        [449.20486, 272.75696],
        [456.35114, 252.46887],
        [442.16806, 279.07245],
        [429.1345, 252.1838],
        [436.31674, 274.50357],
        [449.51767, 252.42854],
        [442.83496, 252.56802],
        [422.12433, 264.84232],
        [442.65878, 265.9005],
        [445.6047, 272.7703],
    ],
    # Third sub-array
    [
        [407.8788, 233.56268],
        [415.1226, 242.40102],
        [390.5832, 218.45311],
        [409.74084, 221.31888],
        [411.25385, 250.6668],
        [408.3905, 238.17776],
        [416.8141, 244.96173],
        [385.64902, 217.06818],
        [398.99576, 217.10063],
        [406.9683, 252.24808],
        [413.37772, 246.345],
        [364.2379, 236.60979],
        [416.83, 231.10522],
        [412.23285, 226.56355],
        [415.14322, 246.47298],
        [407.8788, 233.56268],
        [415.0753, 253.02823],
        [388.36896, 244.97299],
        [411.1218, 219.38107],
        [405.1276, 217.41028],
        [417.48648, 248.86485],
        [417.7085, 256.9162],
        [364.08246, 236.95097],
        [409.9715, 224.90462],
        [410.9226, 227.53925],
        [408.4934, 254.62686],
        [405.90802, 258.30103],
        [424.84195, 236.02585],
    ],
]

segment_4_final = [
    # First sub-array
    [
        [461.65558, 326.89835],
        [445.95865, 317.7105],
        [458.82947, 327.33725],
        [469.31165, 297.56897],
        [468.4021, 312.3887],
        [454.03262, 321.28333],
        [454.01392, 314.94092],
        [467.91354, 312.27896],
        [454.01392, 314.94092],
        [446.55493, 323.42972],
        [468.4021, 312.3887],
        [454.67746, 323.66193],
        [445.95865, 317.7105],
        [470.16702, 301.44177],
        [461.54755, 330.64206],
        [468.4021, 312.3887],
        [452.33176, 336.48523],
        [448.70993, 310.27765],
        [468.4758, 308.82733],
        [465.58908, 315.32742],
        [460.34476, 315.94272],
        [440.78232, 320.41464],
        [458.82947, 327.33725],
        [471.3747, 288.51874],
        [448.70993, 310.27765],
        [442.5784, 333.18887],
        [454.01392, 314.94092],
        [456.26727, 329.21347],
    ],
    # Second sub-array
    [
        [464.82758, 302.10217],
        [448.9714, 274.4608],
        [454.76193, 292.09103],
        [453.07697, 278.41818],
        [437.2012, 277.65933],
        [465.6696, 290.55856],
        [436.7321, 283.49258],
        [452.7855, 289.8599],
        [465.88522, 273.39157],
        [458.22864, 288.03452],
        [449.39984, 279.70154],
        [449.79233, 275.8275],
        [443.56238, 293.23502],
        [449.79233, 275.8275],
        [439.56842, 284.16614],
        [464.82758, 302.10217],
        [465.88522, 273.39157],
        [437.2012, 277.65933],
        [453.6225, 301.2259],
        [465.88522, 273.39157],
        [444.32672, 294.6096],
        [434.96246, 278.43646],
        [442.59195, 294.337],
        [458.3144, 276.2624],
        [450.90558, 277.10364],
        [431.17245, 282.20566],
        [452.7855, 289.8599],
        [450.94162, 299.5014],
    ],
    # Third sub-array
    [
        [418.17978, 245.74457],
        [423.15848, 265.18347],
        [409.41946, 227.56215],
        [425.4624, 242.83809],
        [414.13715, 264.40677],
        [417.00058, 251.0275],
        [425.38586, 268.2032],
        [400.82602, 227.41977],
        [416.41577, 229.76314],
        [408.8575, 263.65738],
        [424.1999, 265.3029],
        [362.79474, 235.80772],
        [425.23746, 250.71654],
        [428.84366, 239.01125],
        [425.37793, 266.40897],
        [418.17978, 245.74457],
        [425.0994, 267.52982],
        [391.02963, 249.84912],
        [430.01056, 234.58083],
        [429.77005, 230.01233],
        [425.23108, 271.66974],
        [424.89407, 272.91956],
        [362.6414, 236.0449],
        [423.1912, 242.717],
        [425.45728, 239.69696],
        [411.19815, 267.18088],
        [407.08603, 270.0307],
        [433.8665, 257.82965],
    ],
]

# Convert to numpy arrays for easier manipulation if needed
segment_0_initial = [np.array(sub_array) for sub_array in segment_0_initial]
segment_0_final = [np.array(sub_array) for sub_array in segment_0_final]
segment_1_initial = [np.array(sub_array) for sub_array in segment_1_initial]
segment_1_final = [np.array(sub_array) for sub_array in segment_1_final]
segment_2_initial = [np.array(sub_array) for sub_array in segment_2_initial]
segment_2_final = [np.array(sub_array) for sub_array in segment_2_final]
segment_3_initial = [np.array(sub_array) for sub_array in segment_3_initial]
segment_3_final = [np.array(sub_array) for sub_array in segment_3_final]
segment_4_initial = [np.array(sub_array) for sub_array in segment_4_initial]
segment_4_final = [np.array(sub_array) for sub_array in segment_4_final]

# Create a dictionary to organize all the data
position_data = {
    "segment_0": {"initial": segment_0_initial, "final": segment_0_final},
    "segment_1": {"initial": segment_1_initial, "final": segment_1_final},
    "segment_2": {"initial": segment_2_initial, "final": segment_2_final},
    "segment_3": {"initial": segment_3_initial, "final": segment_3_final},
    "segment_4": {"initial": segment_4_initial, "final": segment_4_final},
}

print("Position data conversion complete!")
print(f"Total segments: {len(position_data)}")
for segment_name, data in position_data.items():
    print(f"{segment_name}: {len(data['initial'])} sub-arrays in initial, {len(data['final'])} sub-arrays in final")
    print(f"  First sub-array shape - initial: {data['initial'][0].shape}, final: {data['final'][0].shape}")


pre_reconstruction = segment_1_final
post_reconstruction = segment_2_initial

pre_reconstruction_1 = pre_reconstruction[0]
pre_reconstruction_2 = pre_reconstruction[1]
pre_reconstruction_3 = pre_reconstruction[2]

post_reconstruction_1 = post_reconstruction[0]
post_reconstruction_2 = post_reconstruction[1]
post_reconstruction_3 = post_reconstruction[2]


# Extract x and y coordinates for each list
def extract_coords(coord_list):
    return [point[0] for point in coord_list], [point[1] for point in coord_list]


# Pre-reconstruction coordinates
pre_x1, pre_y1 = extract_coords(pre_reconstruction_1)
pre_x2, pre_y2 = extract_coords(pre_reconstruction_2)
pre_x3, pre_y3 = extract_coords(pre_reconstruction_3)

# Post-reconstruction coordinates
post_x1, post_y1 = extract_coords(post_reconstruction_1)
post_x2, post_y2 = extract_coords(post_reconstruction_2)
post_x3, post_y3 = extract_coords(post_reconstruction_3)

all_x = pre_x1 + pre_x2 + pre_x3 + post_x1 + post_x2 + post_x3
all_y = pre_y1 + pre_y2 + pre_y3 + post_y1 + post_y2 + post_y3
x_min, x_max = min(all_x), max(all_x)
y_min, y_max = min(all_y), max(all_y)

# Calculate ranges and make them equal (square aspect ratio)
x_range = x_max - x_min
y_range = y_max - y_min
max_range = max(x_range, y_range)

# Center the ranges and add padding
padding = max_range * 0.1
x_center = (x_min + x_max) / 2
y_center = (y_min + y_max) / 2

# Create equal ranges centered on the data
half_range = (max_range + 2 * padding) / 2
x_lim = (x_center - half_range, x_center + half_range)
y_lim = (y_center - half_range, y_center + half_range)

# Create the figure with two subplots
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(12, 5))

# Colors for the three datasets
colors = ["red", "green", "blue"]

# Plot pre-reconstruction data
ax1.scatter(pre_x1, pre_y1, c=colors[0], label="Red Query Point", s=50, alpha=0.7)
ax1.scatter(pre_x2, pre_y2, c=colors[1], label="Green Query Point", s=50, alpha=0.7)
ax1.scatter(pre_x3, pre_y3, c=colors[2], label="Blue Query Point", s=50, alpha=0.7)
ax1.set_title("Pre-Reconstruction Cloud Points, ROUND_DANCE Segment 2")
ax1.set_xlabel("X (pixels)")
ax1.set_ylabel("Y (pixels)")
ax1.legend()
ax1.grid(True, alpha=0.3)
ax1.set_xlim(x_lim)
ax1.set_ylim(y_lim)
ax1.set_aspect("equal")
ax1.invert_yaxis()

# Plot post-reconstruction data
ax2.scatter(post_x1, post_y1, c=colors[0], label="Red Query Point", s=50, alpha=0.7)
ax2.scatter(post_x2, post_y2, c=colors[1], label="Green Query Point", s=50, alpha=0.7)
ax2.scatter(post_x3, post_y3, c=colors[2], label="Blue Query Point", s=50, alpha=0.7)
ax2.set_title("Post-Reconstruction Cloud Points, ROUND_DANCE Segment 2")
ax2.set_xlabel("X (pixels)")
ax2.set_ylabel("Y (pixels)")
ax2.legend()
ax2.grid(True, alpha=0.3)
ax2.set_xlim(x_lim)
ax2.set_ylim(y_lim)
ax2.set_aspect("equal")
ax2.invert_yaxis()

# Adjust layout to prevent overlap
plt.tight_layout()

# Display the plot
plt.show()

plt.figure(fig)
plt.savefig('cloud_reconstruction.svg', dpi=300, bbox_inches='tight')
